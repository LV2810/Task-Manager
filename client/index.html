<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>Task Manager</title>
        <style>
          body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 40px auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 8px;
          }
          h1 {
            text-align: center;
          }
      
          form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
          }
      
          input[type="text"] {
            flex: 1;
            padding: 8px;
            font-size: 16px;
          }
      
          button {
            padding: 8px 12px;
            font-size: 14px;
            cursor: pointer;
          }
      
          ul {
            list-style-type: none;
            padding: 0;
          }
      
          li {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
          }
      
          span[contenteditable="true"] {
            flex: 1;
            padding: 4px;
            border: 1px dashed transparent;
          }
      
          span[contenteditable="true"]:focus {
            border-color: #007bff;
            outline: none;
          }
        </style>
      </head>      
<body>
  <h1>Task Manager</h1>

  <form id="taskForm">
    <input type="text" id="taskTitle" placeholder="Enter task" required />
    <button type="submit">Add Task</button>
  </form>

  <ul id="taskList"></ul>

  <script>
    const taskForm = document.getElementById('taskForm');
    const taskTitle = document.getElementById('taskTitle');
    const taskList = document.getElementById('taskList');

    const API_URL = 'http://localhost:5000/api/tasks';

    // Load all tasks
    async function loadTasks() {
      const res = await fetch(API_URL);
      const tasks = await res.json();

      taskList.innerHTML = '';
      tasks.forEach(task => {
        const li = document.createElement('li');
        li.innerHTML = `
          <span contenteditable="true" id="task-${task._id}">${task.title}</span>
          <button onclick="updateTask('${task._id}')">Update</button>
          <button onclick="deleteTask('${task._id}')">Delete</button>
        `;
        taskList.appendChild(li);
      });
    }

    // Create task
    taskForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      await fetch(API_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ title: taskTitle.value })
      });
      taskTitle.value = '';
      loadTasks();
    });

    // Delete task
    async function deleteTask(id) {
      await fetch(`${API_URL}/${id}`, {
        method: 'DELETE'
      });
      loadTasks();
    }

    // Update task
    async function updateTask(id) {
      const updatedTitle = document.getElementById(`task-${id}`).innerText;
      await fetch(`${API_URL}/${id}`, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ title: updatedTitle })
      });
      loadTasks();
    }

    // Load tasks on page load
    loadTasks();
  </script>
</body>
</html>
